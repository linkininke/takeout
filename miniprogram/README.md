# 苍穹外卖小程序开发指南

## 开发环境配置

### 1. 安装依赖

小程序项目不需要额外安装依赖，直接使用微信开发者工具打开即可。

### 2. API配置

编辑 `config/api.js` 文件，配置API基础地址：

```javascript
const config = {
  // 开发环境配置
  development: {
    // 替换为你的电脑IP地址
    baseURL: 'http://192.168.1.8:8082/api'
  },
  // 生产环境配置
  production: {
    baseURL: 'https://your-domain.com/api'
  }
};
```

## 本地开发流程

### 1. 启动后端服务

确保后端服务正在运行，端口为8082。

### 2. 打开微信开发者工具

1. 打开微信开发者工具
2. 点击"导入项目"
3. 选择项目目录：`e:\mycode\takeout\miniprogram`
4. 填写AppID：`wx0bd1834578997edf`
5. 点击"导入"按钮

### 3. 开发调试

- 在微信开发者工具中进行代码编辑和调试
- 可以在模拟器中查看效果
- 可以使用真机调试功能进行真机测试

## 真机测试步骤

### 1. 确保网络环境一致

- 确保手机和电脑连接在同一网络下
- 确保电脑的防火墙允许8082端口的访问

### 2. 配置API地址

- 确保 `config/api.js` 中的 `baseURL` 使用的是电脑的实际IP地址，而不是 `localhost` 或 `127.0.0.1`
- 可以在微信开发者工具的控制台查看当前使用的 `baseURL`

### 3. 清除缓存

在真机测试前，建议清除小程序的缓存：

1. 在微信中找到"苍穹外卖"小程序
2. 长按小程序图标，选择"清除缓存"
3. 选择"清除全部缓存"

### 4. 重新进入小程序

- 使用微信开发者工具的"真机调试"功能
- 或者重新扫码进入小程序

### 5. 查看控制台日志

- 在微信开发者工具中打开"真机调试"功能
- 可以查看真机上的控制台日志，了解API调用情况

## 构建和部署

### 1. 构建项目

在微信开发者工具中：

1. 点击"工具"菜单
2. 选择"构建npm"
3. 等待构建完成

### 2. 上传代码

1. 点击"上传"按钮
2. 填写版本号和更新日志
3. 点击"上传"按钮
4. 登录微信公众平台，提交审核

## 常见问题排查

### 1. 代码更改在真机测试中不可见

- 检查是否清除了小程序缓存
- 检查是否使用了最新构建的代码包
- 检查API地址是否配置正确
- 检查是否使用了正确的环境配置

### 2. API调用失败

- 检查电脑和手机是否在同一网络下
- 检查后端服务是否正在运行
- 检查API地址是否配置正确
- 检查防火墙是否允许8082端口的访问

### 3. 页面显示异常

- 检查WXML和WXSS语法是否正确
- 检查JavaScript代码是否有语法错误
- 检查数据绑定是否正确
- 检查微信版本是否兼容

## 开发规范

1. **代码风格**：保持一致的代码风格，使用ES6+语法
2. **API调用**：所有API请求都应该使用 `baseURL` 配置，不要硬编码API地址
3. **错误处理**：所有API调用都应该添加错误处理
4. **日志记录**：在关键位置添加日志，便于调试
5. **性能优化**：避免不必要的API调用，合理使用缓存

## 注意事项

1. 上线前请将 `production.baseURL` 替换为正式的域名
2. 定期备份代码，避免数据丢失
3. 遵循微信小程序开发规范，避免违规操作
4. 关注微信小程序的版本更新，及时适配新功能
