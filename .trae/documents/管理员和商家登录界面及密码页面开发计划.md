# 管理员和商家登录界面及密码页面开发计划

## 一、需求分析

1. 设计一个登录界面，支持管理员和商家登录
2. 开发相应的密码页面（密码修改功能）
3. 利用现有系统的角色管理功能，区分管理员和商家权限

## 二、技术栈

* 前端：Vue 3 + Element Plus + Vue Router + Pinia

* 后端：Spring Boot + Spring Security + MyBatis Plus + JWT

## 三、实现方案

### 1. 登录界面优化

* **现有登录界面分析**：已存在基础登录功能，支持用户名密码登录

* **优化点**：

  * 保持现有登录界面结构不变

  * 确保登录后根据角色ID跳转至相应的权限页面

  * 利用现有角色管理系统，无需额外开发角色区分逻辑

### 2. 密码修改页面开发

* **功能需求**：

  * 支持用户修改自己的密码

  * 密码强度验证

  * 旧密码验证

  * 新密码确认

### 3. 后端接口开发

* **现有接口分析**：已存在登录接口 `/auth/login`

* **新增接口**：

  * `PUT /user/password` - 修改密码接口

### 4. 数据库设计

* **现有表结构**：

  * `user` 表：存储用户信息，包含 `role_id` 字段

  * `role` 表：存储角色信息

* **无需新增表**：利用现有表结构即可

## 四、详细开发步骤

### 1. 前端开发

#### 1.1 密码修改页面组件

* 创建 `Password.vue` 组件

* 设计密码修改表单，包含：

  * 旧密码输入框

  * 新密码输入框（带密码强度验证）

  * 确认新密码输入框

  * 提交按钮

#### 1.2 路由配置

* 在 `router/index.js` 中添加密码修改路由

* 配置路由元信息，要求认证

#### 1.3 状态管理

* 利用现有 `user` store，无需额外开发

#### 1.4 表单验证

* 实现旧密码验证

* 实现新密码强度验证（至少8位，包含字母和数字）

* 实现新密码与确认密码一致性验证

### 2. 后端开发

#### 2.1 Controller 层

* 在 `UserController` 中添加修改密码接口

* 接收旧密码、新密码参数

* 返回修改结果

#### 2.2 Service 层

* 在 `UserService` 中添加修改密码方法

* 验证旧密码正确性

* 加密新密码

* 更新用户密码

#### 2.3 安全性考虑

* 使用 BCrypt 加密新密码

* 验证旧密码防止恶意修改

* 添加接口权限控制

## 五、测试计划

### 1. 单元测试

* 后端修改密码接口测试

* 密码加密与验证测试

### 2. 集成测试

* 登录功能测试（管理员和商家）

* 密码修改功能测试

* 权限控制测试

### 3. 前端测试

* 表单验证测试

* 页面跳转测试

* 错误提示测试

## 六、部署计划

* 前端构建：`npm run build`

* 后端构建：`mvn clean package`

* 部署到现有服务器

## 七、预期效果

1. 管理员和商家可以使用同一登录界面登录
2. 登录后根据角色权限显示不同的功能菜单
3. 用户可以在系统中修改自己的密码
4. 密码修改过程安全可靠，有完善的验证机制

## 八、开发时间预估

* 前端开发：2小时

* 后端开发：1小时

* 测试与调试：1小时

* 总计：4小时

## 九、风险评估

1. **风险**：现有角色管理系统可能不支持商家角色
   **应对**：检查现有角色数据，如需添加商家角色，使用现有角色管理功能添加

2. **风险**：密码修改接口可能存在安全漏洞
   **应对**：严格验证旧密码，使用安全的密码加密算法，添加接口权限控制

3. **风险**：前端表单验证可能不充分
   **应对**：实现前端和后端双重验证，确保密码安全

## 十、依赖关系

* 依赖现有登录功能

* 依赖现有角色管理功能

* 依赖现有用户管理功能

